{"version":3,"sources":["../../src/core/mainmenu/pages/more/more.module.ts","../../src/core/mainmenu/pages/more/more.ts"],"names":[],"mappings":"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","file":"24.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreMainMenuMorePage } from './more';\r\nimport { CoreComponentsModule } from '@components/components.module';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        CoreMainMenuMorePage,\r\n    ],\r\n    imports: [\r\n        CoreComponentsModule,\r\n        CoreDirectivesModule,\r\n        IonicPageModule.forChild(CoreMainMenuMorePage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class CoreMainMenuPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/mainmenu/pages/more/more.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, OnDestroy } from '@angular/core';\r\nimport { IonicPage, NavController } from 'ionic-angular';\r\nimport { CoreEventsProvider } from '@providers/events';\r\nimport { CoreSitesProvider , CoreSiteBasicInfo} from '@providers/sites';\r\nimport { CoreMainMenuDelegate, CoreMainMenuHandlerData } from '../../providers/delegate';\r\nimport { CoreMainMenuProvider, CoreMainMenuCustomItem } from '../../providers/mainmenu';\r\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\r\nimport { CoreTextUtilsProvider } from '@providers/utils/text';\r\nimport { CoreLoginHelperProvider } from '../../../../core/login/providers/helper';\r\n\r\n/**\r\n * Page that displays the list of main menu options that aren't in the tabs.\r\n */\r\n@IonicPage({segment: 'core-mainmenu-more'})\r\n@Component({\r\n    selector: 'page-core-mainmenu-more',\r\n    templateUrl: 'more.html',\r\n})\r\nexport class CoreMainMenuMorePage implements OnDestroy {\r\n    sites: CoreSiteBasicInfo[];\r\n    handlers: CoreMainMenuHandlerData[];\r\n    handlersLoaded: boolean;\r\n    siteInfo: any;\r\n    logoutLabel: string;\r\n    showWeb: boolean;\r\n    showHelp: boolean;\r\n    docsUrl: string;\r\n    customItems: CoreMainMenuCustomItem[];\r\n\r\n    protected subscription;\r\n    protected langObserver;\r\n    protected updateSiteObserver;\r\n\r\n    constructor(private domUtils: CoreDomUtilsProvider, private textUtils: CoreTextUtilsProvider, \r\n            private menuDelegate: CoreMainMenuDelegate, private sitesProvider: CoreSitesProvider,\r\n            private navCtrl: NavController, private mainMenuProvider: CoreMainMenuProvider, \r\n            private loginHelper: CoreLoginHelperProvider,\r\n            eventsProvider: CoreEventsProvider) {\r\n\r\n        this.langObserver = eventsProvider.on(CoreEventsProvider.LANGUAGE_CHANGED, this.loadSiteInfo.bind(this));\r\n        this.updateSiteObserver = eventsProvider.on(CoreEventsProvider.SITE_UPDATED, this.loadSiteInfo.bind(this),\r\n            sitesProvider.getCurrentSiteId());\r\n        this.loadSiteInfo();\r\n    }\r\n\r\n    /**\r\n     * View loaded.\r\n     */\r\n    ionViewDidLoad(): void {\r\n        // Load the handlers.\r\n        this.subscription = this.menuDelegate.getHandlers().subscribe((handlers) => {\r\n            // Calculate the main handlers to not display them in this view.\r\n            const mainHandlers = handlers.filter((handler) => {\r\n                return !handler.onlyInMore;\r\n            }).slice(0, CoreMainMenuProvider.NUM_MAIN_HANDLERS);\r\n\r\n            // Get only the handlers that don't appear in the main view.\r\n            this.handlers = [];\r\n            handlers.forEach((handler) => {\r\n                if (mainHandlers.indexOf(handler) == -1) {\r\n                    this.handlers.push(handler);\r\n                }\r\n            });\r\n\r\n            this.handlersLoaded = this.menuDelegate.areHandlersLoaded();\r\n        });\r\n\r\n        this.sitesProvider.getSortedSites().then((sites) => {\r\n            // Remove protocol from the url to show more url text.\r\n            this.sites = sites.map((site) => {\r\n                site.siteUrl = site.siteUrl.replace(/^https?:\\/\\//, '');\r\n                site.badge = 0;\r\n\r\n                return site;\r\n            });\r\n\r\n        }).catch(() => {\r\n            // Shouldn't happen.\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Page destroyed.\r\n     */\r\n    ngOnDestroy(): void {\r\n        if (this.subscription) {\r\n            this.subscription.unsubscribe();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load the site info required by the view.\r\n     */\r\n    protected loadSiteInfo(): void {\r\n        const currentSite = this.sitesProvider.getCurrentSite(),\r\n            config = currentSite.getStoredConfig();\r\n\r\n        this.siteInfo = currentSite.getInfo();\r\n        this.logoutLabel = 'core.mainmenu.' + (config && config.tool_mobile_forcelogout == '1' ? 'logout' : 'changesite');\r\n        this.showWeb = !currentSite.isFeatureDisabled('CoreMainMenuDelegate_website');\r\n        this.showHelp = !currentSite.isFeatureDisabled('CoreMainMenuDelegate_help');\r\n\r\n        currentSite.getDocsUrl().then((docsUrl) => {\r\n            this.docsUrl = docsUrl;\r\n        });\r\n\r\n        this.mainMenuProvider.getCustomMenuItems().then((items) => {\r\n            this.customItems = items;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Open a handler.\r\n     *\r\n     * @param {CoreMainMenuHandlerData} handler Handler to open.\r\n     */\r\n    openHandler(handler: CoreMainMenuHandlerData): void {\r\n        this.navCtrl.push(handler.page, handler.pageParams);\r\n    }\r\n\r\n    /**\r\n     * Open an embedded custom item.\r\n     *\r\n     * @param {CoreMainMenuCustomItem} item Item to open.\r\n     */\r\n    openItem(item: CoreMainMenuCustomItem): void {\r\n        this.navCtrl.push('CoreViewerIframePage', {title: item.label, url: item.url});\r\n    }\r\n\r\n    /**\r\n     * Open settings page.\r\n     */\r\n    openPinSettingsPage(): void {\r\n        this.navCtrl.push('ConfirmexistingpinPage');\r\n    }\r\n\r\n    /**\r\n     * Open settings page.\r\n     */\r\n    openSettings(): void {\r\n        this.navCtrl.push('CoreSettingsListPage');\r\n    }\r\n\r\n    /**\r\n     * Logout the user.\r\n     */\r\n    logout(): void {\r\n        this.sitesProvider.logout();\r\n    }\r\n\r\n    customLogOutWithDelete(): void {\r\n        \r\n// tslint:disable-next-line: no-console\r\n        console.log(this.sites);\r\n\r\n        const index = 0;\r\n        const site = this.sites[index],\r\n        siteName = site.siteName;\r\n\r\n        this.textUtils.formatText(siteName).then((siteName) => {\r\n            this.sitesProvider.deleteSite(site.id).then(() => {\r\n                this.sites.splice(index, 1);\r\n                // If there are no sites left, go to add site.\r\n                this.sitesProvider.hasSites().then((hasSites) => {\r\n                    if (!hasSites) {\r\n                        this.loginHelper.goToAddSite(true, true);\r\n                    }\r\n                });\r\n            }).catch((error) => {\r\n              //  this.logger.error('Error deleting site ' + site.id, error);\r\n                this.domUtils.showErrorModalDefault(error, 'Delete site failed.');\r\n                this.domUtils.showErrorModal('core.login.errordeletesite', true);\r\n            });\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/mainmenu/pages/more/more.ts"],"sourceRoot":""}